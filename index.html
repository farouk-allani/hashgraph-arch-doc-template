<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.26">
<title>Enda Tamweel HTS-Based Loyalty Tokenization Platform: Architecture Overview</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock pre>code{display:block}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Enda Tamweel HTS-Based Loyalty Tokenization Platform: Architecture Overview</h1>
<div class="details">
<span id="revnumber">version 1.0,</span>
<span id="revdate">2025-12-17</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction_and_goals">1. Introduction and Goals</a>
<ul class="sectlevel2">
<li><a href="#_executive_summary">1.1. Executive Summary</a></li>
<li><a href="#_stakeholders">1.2. Stakeholders</a></li>
<li><a href="#_requirements_overview">1.3. Requirements Overview</a></li>
<li><a href="#_quality_goals">1.4. Quality Goals</a></li>
<li><a href="#_glossary">1.5. Glossary</a></li>
</ul>
</li>
<li><a href="#_architecture">2. Architecture</a>
<ul class="sectlevel2">
<li><a href="#_technical_constraints">2.1. Technical Constraints</a></li>
<li><a href="#_organizational_constraints">2.2. Organizational Constraints</a></li>
<li><a href="#_conventions">2.3. Conventions</a></li>
<li><a href="#_system_context">2.4. System Context</a></li>
<li><a href="#_container_view">2.5. Container View</a></li>
<li><a href="#_component_diagram">2.6. Component Diagram</a></li>
<li><a href="#_runtime_view">2.7. Runtime View</a></li>
<li><a href="#_deployment_view">2.8. Deployment View</a></li>
</ul>
</li>
<li><a href="#_cross_cutting_concepts">3. Cross-cutting Concepts</a>
<ul class="sectlevel2">
<li><a href="#_overview_5">3.1. Overview</a></li>
<li><a href="#_security_concept">3.2. Security Concept</a></li>
<li><a href="#_performance_optimization">3.3. Performance Optimization</a></li>
<li><a href="#_monitoring_and_logging">3.4. Monitoring and Logging</a></li>
<li><a href="#_data_protection_and_privacy">3.5. Data Protection and Privacy</a></li>
</ul>
</li>
<li><a href="#_architecture_decisions">4. Architecture Decisions</a>
<ul class="sectlevel2">
<li><a href="#_adr_001_use_hedera_token_service_hts_for_loyalty_points_tokenization">4.1. ADR 001: Use Hedera Token Service (HTS) for Loyalty Points Tokenization</a></li>
<li><a href="#_adr_002_use_nestjs_as_backend_framework">4.2. ADR 002: Use NestJS as Backend Framework</a></li>
<li><a href="#_adr_003_jwt_authentication_with_refresh_token_rotation">4.3. ADR 003: JWT Authentication with Refresh Token Rotation</a></li>
<li><a href="#_adr_004_custodial_wallet_architecture_for_client_hedera_accounts">4.4. ADR 004: Custodial Wallet Architecture for Client Hedera Accounts</a></li>
<li><a href="#_adr_005_daily_batch_processing_for_points_calculation_and_token_minting">4.5. ADR 005: Daily Batch Processing for Points Calculation and Token Minting</a></li>
</ul>
</li>
<li><a href="#_quality_assurance_testing_strategy">5. Quality Assurance Testing Strategy</a>
<ul class="sectlevel2">
<li><a href="#_testing_scope">5.1. Testing Scope</a></li>
<li><a href="#_testing_levels">5.2. Testing Levels</a></li>
<li><a href="#_testing_strategy">5.3. Testing Strategy</a></li>
</ul>
</li>
<li><a href="#_risk_technical_debt">6. Risk &amp; Technical Debt</a>
<ul class="sectlevel2">
<li><a href="#_risks">6.1. Risks</a></li>
<li><a href="#_technical_debt">6.2. Technical Debt</a></li>
</ul>
</li>
<li><a href="#_features_traceability_matrix_rtm">7. Features Traceability Matrix (RTM)</a>
<ul class="sectlevel2">
<li><a href="#_coverage_summary">7.1. Coverage Summary</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction_and_goals">1. Introduction and Goals</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_executive_summary">1.1. Executive Summary</h3>
<div class="paragraph">
<p>The Enda Tamweel HTS-Based Loyalty Tokenization Platform is a loyalty and client fidelization system that manages client points using traditional databases combined with Hedera Hashgraph&#8217;s HTS (Hedera Token Service). Points are tokenized as mintable and burnable HTS tokens that reflect the points accumulated by each client.</p>
</div>
<div class="paragraph">
<p>The platform integrates Enda Tamweel&#8217;s existing T24 and Works systems through an intermediate consolidated database (Middle DB), updated daily (J-1). Based on extracted data, daily points are calculated for each client, stored in the application database, and reflected in their on-chain token balances.</p>
</div>
<div class="paragraph">
<p>Key capabilities include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Automatic Hedera account creation for each registered client</p>
</li>
<li>
<p>Daily points calculation based on client activity from the Middle DB</p>
</li>
<li>
<p>Automatic minting of HTS loyalty tokens to client accounts</p>
</li>
<li>
<p>Gift redemption workflow with admin approval and token burning</p>
</li>
<li>
<p>Multi-tier role management (Client, Admin, Super Admin)</p>
</li>
<li>
<p>Secure JWT-based authentication with token rotation</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_stakeholders">1.2. Stakeholders</h3>
<table id="stakeholders" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Contact</th>
<th class="tableblock halign-left valign-top">Expectations</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enda Tamweel Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enda Tamweel Team</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Successful loyalty program that increases client engagement and retention</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Product Owner</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dar Blockchain Team</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feature completeness and seamless integration with existing T24/Works systems</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Project Manager</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dar Blockchain Team</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">On-time delivery within budget with clear milestone tracking</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tech Lead</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dar Blockchain Team</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code quality, Hedera integration, and technical implementation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backend Developers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dar Blockchain Team</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clear API specifications and maintainable codebase</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frontend Developers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dar Blockchain Team</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Intuitive UI/UX for clients and administrators</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">System Administrators</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enda Tamweel IT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Easy deployment, monitoring, and maintenance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clients (End Users)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enda Tamweel Customers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Easy access to loyalty points, transparent balance tracking, and simple gift redemption</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_requirements_overview">1.3. Requirements Overview</h3>
<div class="sect3">
<h4 id="_functional_requirements">1.3.1. Functional Requirements</h4>
<table id="requirements" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 88.8889%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ID</th>
<th class="tableblock halign-left valign-top">Requirement</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RE1"></a>R1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Automatic Hedera wallet creation upon client registration with secure private key storage</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RE2"></a>R2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily extraction of client activity data from Middle DB (J-1 refresh cycle)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RE3"></a>R3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rule-based points calculation engine processing Middle DB data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RE4"></a>R4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Automatic minting of HTS loyalty tokens based on calculated points</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RE5"></a>R5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gift redemption workflow with Admin approval and token burning</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RE6"></a>R6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Super Admin panel for Admin lifecycle management</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RE7"></a>R7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JWT-based authentication with refresh token rotation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RE8"></a>R8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regular reconciliation between database and on-chain token balances</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RE9"></a>R9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Storage of historical point calculations and redemption logs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RE10"></a>R10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web and Mobile application interfaces for clients and administrators</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_integration_requirements">1.3.2. Integration Requirements</h4>
<table id="integration-requirements" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 88.8889%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ID</th>
<th class="tableblock halign-left valign-top">Requirement</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="IR1"></a>IR1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integration with Enda Tamweel&#8217;s Middle DB (consolidated T24 and Works data)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="IR2"></a>IR2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integration with Hedera Token Service (HTS) for token management</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="IR3"></a>IR3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Account Service for wallet creation and management</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_quality_goals">1.4. Quality Goals</h3>
<table id="quality-goals" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 8.3333%;">
<col style="width: 25%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ID</th>
<th class="tableblock halign-left valign-top">Quality</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="Q1"></a>Q1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private keys encrypted at rest; JWT tokens with short expiry; refresh tokens stored hashed in DB; HTTPS-only communication; HTTP-only secure cookies for refresh tokens</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="Q2"></a>Q2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reliability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily batch processing must complete successfully; reconciliation between DB and on-chain balances; comprehensive audit logging</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="Q3"></a>Q3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">API responses within 2 seconds for 95% of requests; batch minting operations optimized for large user bases</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="Q4"></a>Q4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scalability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Asynchronous job queue for daily point calculations; batch mint operations to handle growing client base</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="Q5"></a>Q5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System available during business hours with scheduled maintenance windows for batch operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="Q6"></a>Q6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maintainability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clean separation between business logic and Hedera integration; comprehensive logging for troubleshooting</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="Q7"></a>Q7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auditability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complete audit trail for all token minting, burning, and redemption operations; login/logout event logging</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="Q8"></a>Q8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regular reconciliation between application database and on-chain token balances</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_glossary">1.5. Glossary</h3>
<table id="glossary" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 88.8889%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Term</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="HTS"></a>HTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Token Service - A native tokenization service on Hedera Hashgraph for creating and managing fungible and non-fungible tokens</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="DLT"></a>DLT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decentralised Ledger Technology</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="JWT"></a>JWT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON Web Token - A compact, URL-safe means of representing claims to be transferred between two parties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="MiddleDB"></a>Middle DB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Intermediate consolidated database that aggregates data from Enda Tamweel&#8217;s T24 and Works systems, updated daily (J-1)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="T24"></a>T24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temenos T24 - Core banking system used by Enda Tamweel</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="Works"></a>Works</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enda Tamweel&#8217;s operational system integrated with T24</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="J-1"></a>J-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day minus one - refers to data from the previous business day</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="HBAR"></a>HBAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The native cryptocurrency of the Hedera network used to pay for transaction fees</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="Minting"></a>Minting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process of creating new tokens on the Hedera network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="Burning"></a>Burning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process of permanently removing tokens from circulation on the Hedera network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[[Refresh Token]]Refresh Token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A long-lived token used to obtain new access tokens without requiring the user to re-authenticate</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture">2. Architecture</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>List key constraints that influence architectural decisions. Keep this list updated as project constraints evolve.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_technical_constraints">2.1. Technical Constraints</h3>
<div class="ulist">
<ul>
<li>
<p>Must integrate with Hedera Token Service (HTS) for token minting and burning</p>
</li>
<li>
<p>Must integrate with Enda Tamweel&#8217;s existing Middle DB (read-only access)</p>
</li>
<li>
<p>Must support secure storage of client Hedera private keys</p>
</li>
<li>
<p>Must implement JWT-based authentication with secure refresh token handling</p>
</li>
<li>
<p>Daily batch processing must align with Middle DB J-1 update cycle</p>
</li>
<li>
<p>Token operations must be performed by platform-controlled admin keys only</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_organizational_constraints">2.2. Organizational Constraints</h3>
<div class="ulist">
<ul>
<li>
<p>Integration with existing Enda Tamweel T24 and Works systems</p>
</li>
<li>
<p>Must align with Enda Tamweel&#8217;s security and compliance requirements</p>
</li>
<li>
<p>Development by Dar Blockchain Team with defined delivery timeline</p>
</li>
<li>
<p>Points cannot be used externally - closed ecosystem</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_conventions">2.3. Conventions</h3>
<div class="ulist">
<ul>
<li>
<p>Backend developed using NestJS framework</p>
</li>
<li>
<p>Frontend using React (Web) and React Native (Mobile)</p>
</li>
<li>
<p>PostgreSQL for application database</p>
</li>
<li>
<p>RESTful API design principles</p>
</li>
<li>
<p>Comprehensive logging and audit trails</p>
</li>
<li>
<p>Asynchronous job processing for batch operations</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This section presents the static structure of the system using C4 model diagrams. Each level provides increasing detail about the software architecture. Update these diagrams when adding, removing, or significantly changing system components.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_system_context">2.4. System Context</h3>
<div class="sect3">
<h4 id="_overview">2.4.1. Overview</h4>
<div class="paragraph">
<p>This diagram shows the systems that are communicating and interacting within the scope of the Enda Tamweel Loyalty Tokenization Platform. The platform bridges traditional banking systems with Hedera&#8217;s blockchain-based tokenization.</p>
</div>
</div>
<div class="sect3">
<h4 id="_context_diagram">2.4.2. Context Diagram</h4>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-e5b427c6c5c507a4a6804c359c434411.png" alt="Diagram" width="928" height="1013">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_key_elements">2.4.3. Key Elements</h4>
<div class="sect4">
<h5 id="_client">Client</h5>
<div class="paragraph">
<p>Enda Tamweel customers who participate in the loyalty program. Clients can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>View their current loyalty point balance (both in-app and on-chain)</p>
</li>
<li>
<p>Browse available gifts in the catalog</p>
</li>
<li>
<p>Request gift redemptions</p>
</li>
<li>
<p>Track their redemption history</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_admin">Admin</h5>
<div class="paragraph">
<p>Enda Tamweel employees responsible for managing the loyalty program. Admins can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>View and manage the gift catalog</p>
</li>
<li>
<p>Review and approve/reject client redemption requests</p>
</li>
<li>
<p>Manually create client accounts when needed</p>
</li>
<li>
<p>View client transaction history</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_super_admin">Super Admin</h5>
<div class="paragraph">
<p>Senior administrators with elevated privileges. Super Admins can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create, modify, and deactivate Admin accounts</p>
</li>
<li>
<p>View comprehensive audit logs</p>
</li>
<li>
<p>Access system-wide reports and analytics</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_loyalty_platform_frontend">Loyalty Platform (Frontend)</h5>
<div class="paragraph">
<p>The user-facing applications built with React (Web) and React Native (Mobile). The frontend provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Responsive web application for desktop and tablet users</p>
</li>
<li>
<p>Native mobile applications for iOS and Android</p>
</li>
<li>
<p>Role-based interfaces for Clients, Admins, and Super Admins</p>
</li>
<li>
<p>Real-time balance display and transaction history</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_backend_service">Backend Service</h5>
<div class="paragraph">
<p>The core NestJS application that orchestrates all platform operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fetches and processes data from Middle DB</p>
</li>
<li>
<p>Calculates daily points based on business rules</p>
</li>
<li>
<p>Manages Hedera account creation and token operations</p>
</li>
<li>
<p>Exposes secure REST APIs for all frontend operations</p>
</li>
<li>
<p>Handles authentication and authorization</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_middle_db_external">Middle DB (External)</h5>
<div class="paragraph">
<p>Enda Tamweel&#8217;s consolidated database that aggregates data from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>T24 core banking system</p>
</li>
<li>
<p>Works operational system</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Updated daily with J-1 data cycle. The platform has read-only access for extracting client activity information.</p>
</div>
</div>
<div class="sect4">
<h5 id="_hedera_hashgraph_external">Hedera Hashgraph (External)</h5>
<div class="paragraph">
<p>The distributed ledger network providing:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hedera Token Service (HTS) for the loyalty token</p>
</li>
<li>
<p>Account creation for each registered client</p>
</li>
<li>
<p>Immutable transaction records for minting and burning operations</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_container_view">2.5. Container View</h3>
<div class="sect3">
<h4 id="_overview_2">2.5.1. Overview</h4>
<div class="paragraph">
<p>This diagram shows the container images and their interactions within the Enda Tamweel Loyalty Tokenization Platform.</p>
</div>
</div>
<div class="sect3">
<h4 id="_container_diagram">2.5.2. Container Diagram</h4>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-66bed8c6265f13a760ee4cc2f0cadd44.png" alt="Diagram" width="958" height="1115">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_description_of_containers">2.5.3. Description of Containers</h4>
<div class="sect4">
<h5 id="_web_application">Web Application</h5>
<div class="paragraph">
<p>Built with React, the web application provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Responsive design for desktop and tablet browsers</p>
</li>
<li>
<p>Role-based dashboards (Client, Admin, Super Admin)</p>
</li>
<li>
<p>Real-time balance display</p>
</li>
<li>
<p>Gift catalog and redemption workflow</p>
</li>
<li>
<p>Admin management interface for Super Admins</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Key design choices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JWT access tokens stored in memory only (not localStorage) to prevent XSS attacks</p>
</li>
<li>
<p>Refresh tokens handled via HTTP-only secure cookies</p>
</li>
<li>
<p>Modern React patterns with hooks and context</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_mobile_application">Mobile Application</h5>
<div class="paragraph">
<p>Built with React Native for cross-platform deployment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Native iOS and Android applications</p>
</li>
<li>
<p>Shared codebase with platform-specific optimizations</p>
</li>
<li>
<p>Push notifications for redemption status updates</p>
</li>
<li>
<p>Offline-capable balance caching</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_backend_service_2">Backend Service</h5>
<div class="paragraph">
<p>The core NestJS application responsible for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>User Management</strong>: Registration, authentication, Hedera wallet creation</p>
</li>
<li>
<p><strong>Points Engine</strong>: Daily calculation based on Middle DB data</p>
</li>
<li>
<p><strong>Token Operations</strong>: Minting loyalty tokens to user accounts, burning on redemption</p>
</li>
<li>
<p><strong>Gift Management</strong>: Catalog CRUD, redemption workflow</p>
</li>
<li>
<p><strong>Admin Management</strong>: Admin lifecycle for Super Admins</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Key design choices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Modular NestJS architecture for separation of concerns</p>
</li>
<li>
<p>Hedera SDK integration for all blockchain operations</p>
</li>
<li>
<p>Encrypted private key storage for user wallets</p>
</li>
<li>
<p>Comprehensive audit logging</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_job_queue">Job Queue</h5>
<div class="paragraph">
<p>Asynchronous job processing using Bull with Redis:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Daily scheduled jobs for Middle DB data extraction</p>
</li>
<li>
<p>Batch points calculation processing</p>
</li>
<li>
<p>Batch token minting operations</p>
</li>
<li>
<p>Retry logic for failed Hedera transactions</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_application_database">Application Database</h5>
<div class="paragraph">
<p>PostgreSQL database storing:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User accounts and encrypted wallet credentials</p>
</li>
<li>
<p>Points calculation history (daily snapshots and cumulative values)</p>
</li>
<li>
<p>Gift catalog and redemption requests</p>
</li>
<li>
<p>Admin and Super Admin accounts</p>
</li>
<li>
<p>Audit logs for all significant operations</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_component_diagram">2.6. Component Diagram</h3>
<div class="sect3">
<h4 id="_overview_3">2.6.1. Overview</h4>
<div class="paragraph">
<p>This document provides a component-level view (C3) of the Enda Tamweel Loyalty Platform, detailing the internal structure of the backend service and its interactions with external systems.</p>
</div>
</div>
<div class="sect3">
<h4 id="_component_diagram_backend_service">2.6.2. <a id="components"></a> Component Diagram - Backend Service</h4>
<div class="paragraph">
<p>The Backend Service is the core of the platform, handling all business logic, data processing, and blockchain interactions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-19e7f2f9438cd2dd39306c24b229e77d.png" alt="Diagram" width="2103" height="801">
</div>
</div>
<div class="sect4">
<h5 id="_auth_module">Auth Module</h5>
<div class="paragraph">
<p>Handles all authentication and authorization:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Login with username/password validation</p>
</li>
<li>
<p>JWT access token generation (short-lived, stored in memory only on client)</p>
</li>
<li>
<p>Refresh token generation (long-lived, HTTP-only secure cookie)</p>
</li>
<li>
<p>Token rotation on refresh (invalidate old, issue new)</p>
</li>
<li>
<p>Session management and logout</p>
</li>
<li>
<p>Role-based access control (Client, Admin, Super Admin)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_user_module">User Module</h5>
<div class="paragraph">
<p>Manages client user accounts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Client registration with automatic Hedera wallet creation</p>
</li>
<li>
<p>Profile management and updates</p>
</li>
<li>
<p>Password management</p>
</li>
<li>
<p>Account status tracking</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_wallet_module">Wallet Module</h5>
<div class="paragraph">
<p>Handles Hedera account operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creates new Hedera accounts for registered clients</p>
</li>
<li>
<p>Generates and securely stores encrypted private keys</p>
</li>
<li>
<p>Manages account associations with the loyalty token</p>
</li>
<li>
<p>Provides signing capabilities for token operations</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_points_engine">Points Engine</h5>
<div class="paragraph">
<p>Core business logic for loyalty points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Processes daily data extracted from Middle DB</p>
</li>
<li>
<p>Applies configurable business rules to calculate points</p>
</li>
<li>
<p>Tracks loan behavior, user activity, payment events</p>
</li>
<li>
<p>Stores daily snapshots and cumulative point values</p>
</li>
<li>
<p>Triggers token minting for calculated points</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_token_module">Token Module</h5>
<div class="paragraph">
<p>Manages all HTS token operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mints loyalty tokens to client Hedera accounts</p>
</li>
<li>
<p>Burns tokens when gifts are redeemed</p>
</li>
<li>
<p>Maintains reconciliation between database and on-chain balances</p>
</li>
<li>
<p>Uses platform admin key for all mint/burn operations</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_gift_module">Gift Module</h5>
<div class="paragraph">
<p>Manages the gift redemption workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gift catalog CRUD operations</p>
</li>
<li>
<p>Redemption request creation and tracking</p>
</li>
<li>
<p>Admin approval/rejection workflow</p>
</li>
<li>
<p>Triggers token burning on approved redemptions</p>
</li>
<li>
<p>Logs all redemption transactions</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_admin_module">Admin Module</h5>
<div class="paragraph">
<p>Administrative functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Admin account CRUD for Super Admins</p>
</li>
<li>
<p>Admin role and permission management</p>
</li>
<li>
<p>System configuration management</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_data_sync_service">Data Sync Service</h5>
<div class="paragraph">
<p>Scheduled data synchronization:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Nightly cron job for Middle DB data extraction</p>
</li>
<li>
<p>Read-only access to Middle DB</p>
</li>
<li>
<p>Logging for each import session</p>
</li>
<li>
<p>Error handling and retry logic</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_audit_module">Audit Module</h5>
<div class="paragraph">
<p>Compliance and audit logging:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Logs all authentication events (login, logout, refresh)</p>
</li>
<li>
<p>Logs all token operations (mint, burn)</p>
</li>
<li>
<p>Logs all redemption transactions</p>
</li>
<li>
<p>Logs admin actions</p>
</li>
<li>
<p>Provides audit trail query interface</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_runtime_view">2.7. Runtime View</h3>
<div class="paragraph">
<p>This section describes the key runtime scenarios of the Enda Tamweel Loyalty Platform, illustrating how components interact during important operations.</p>
</div>
<div class="sect3">
<h4 id="_user_registration_and_wallet_creation">2.7.1. User Registration and Wallet Creation</h4>
<div class="paragraph">
<p>This sequence shows how a new client is registered and their Hedera wallet is created.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-abbf226be5be4a4e2eeaa9581ac2dd80.png" alt="Diagram" width="1053" height="697">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_authentication_flow">2.7.2. Authentication Flow</h4>
<div class="sect4">
<h5 id="_login_token_issuance">Login &amp; Token Issuance</h5>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-3791ba4062890dd01603b99be5cf7cbb.png" alt="Diagram" width="1003" height="728">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_access_token_expiry_refresh">Access Token Expiry &amp; Refresh</h5>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-41777735875708565a116e7f168761e4.png" alt="Diagram" width="1044" height="861">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_logout_flow">Logout Flow</h5>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-91444646119fb7a7e78f4b7bedc1d6fb.png" alt="Diagram" width="897" height="593">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_daily_points_calculation_tokenization">2.7.3. Daily Points Calculation &amp; Tokenization</h4>
<div class="paragraph">
<p>This is the core business process that runs daily to calculate and mint loyalty tokens.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-2c652d858f84b242dd38e2630fea93bc.png" alt="Diagram" width="1215" height="726">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_gift_redemption_token_burning">2.7.4. Gift Redemption &amp; Token Burning</h4>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-0d9e6e4c9038f561be57be5b5e39a256.png" alt="Diagram" width="1525" height="1541">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_balance_reconciliation">2.7.5. Balance Reconciliation</h4>
<div class="paragraph">
<p>Periodic process to ensure database and on-chain balances are synchronized.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-e6ea2baff07cd7b9c3fb7ef8c676858c.png" alt="Diagram" width="771" height="557">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deployment_view">2.8. Deployment View</h3>
<div class="paragraph">
<p>This section describes the technical infrastructure and deployment architecture for the Enda Tamweel Loyalty Platform.</p>
</div>
<div class="sect3">
<h4 id="_infrastructure_overview">2.8.1. Infrastructure Overview</h4>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-1e49e7a7349c38d07b3d1ffa3d66fcd4.png" alt="Diagram" width="1320" height="1183">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_environment_configuration">2.8.2. Environment Configuration</h4>
<div class="sect4">
<h5 id="_production_environment">Production Environment</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 50%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Component</th>
<th class="tableblock halign-left valign-top">Configuration</th>
<th class="tableblock halign-left valign-top">Scaling</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 pod replicas behind load balancer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HPA: 3-10 pods based on CPU</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backend Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 pod replicas with health checks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HPA: 3-15 pods based on requests/sec</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job Workers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 dedicated worker pods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual scaling for batch operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PostgreSQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Managed service with read replicas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vertical scaling + read replicas</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Managed cluster mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vertical scaling</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_staging_environment">Staging Environment</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Component</th>
<th class="tableblock halign-left valign-top">Configuration</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 pod replica</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backend Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 pod replicas</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job Workers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 worker pod</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PostgreSQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single instance (development tier)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single instance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Network</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testnet</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_network_architecture">2.8.3. Network Architecture</h4>
<div class="sect4">
<h5 id="_security_zones">Security Zones</h5>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-dfdbdb74c30c71ed59fdbd481948afb7.png" alt="Diagram" width="907" height="853">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_firewall_rules">Firewall Rules</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Destination</th>
<th class="tableblock halign-left valign-top">Port</th>
<th class="tableblock halign-left valign-top">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDN/Load Balancer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS traffic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Load Balancer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web/API Pods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8080</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal HTTP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API Pods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PostgreSQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5432</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database connections</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API Pods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6379</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cache and queue</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API Pods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API Pods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Middle DB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1433</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data sync (VPN only)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_branching_strategy">2.8.4. Branching Strategy</h4>
<div class="sect4">
<h5 id="_overview_4">Overview</h5>
<div class="paragraph">
<p>The branching strategy ensures stability, collaboration, and smooth release cycles aligned with Enda Tamweel&#8217;s deployment requirements.</p>
</div>
</div>
<div class="sect4">
<h5 id="_branch_types">Branch Types</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Branch</th>
<th class="tableblock halign-left valign-top">Purpose</th>
<th class="tableblock halign-left valign-top">Deployed To</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>main</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Production-ready code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Production environment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>develop</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integration branch for features</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Staging environment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>release/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Release preparation and stabilization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-production testing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>feature/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">New feature development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Developer environments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hotfix/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Production bug fixes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fast-track to production</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_branch_naming_convention">Branch Naming Convention</h5>
<div class="ulist">
<ul>
<li>
<p><code>feature/TICKET-123-user-registration</code></p>
</li>
<li>
<p><code>feature/loyalty-points-calculation</code></p>
</li>
<li>
<p><code>release/1.2.0</code></p>
</li>
<li>
<p><code>hotfix/1.2.1-token-burn-fix</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_branch_workflow">Branch Workflow</h5>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-b9fdf578d330643fad01ed4c4b59b33f.png" alt="Diagram" width="435" height="490">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cicd_pipeline">2.8.5. CI/CD Pipeline</h4>
<div class="sect4">
<h5 id="_pipeline_overview">Pipeline Overview</h5>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-c4e9892ed621e39e1aeeac44109c700c.png" alt="Diagram" width="1226" height="1072">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_pipeline_stages">Pipeline Stages</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Stage</th>
<th class="tableblock halign-left valign-top">Actions</th>
<th class="tableblock halign-left valign-top">Success Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lint, compile, unit tests, build Docker images</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All tests pass, image built successfully</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SAST scan, dependency vulnerability check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No critical/high vulnerabilities</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deploy Staging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deploy to staging K8s cluster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pods healthy, endpoints responding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integration Tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">API integration tests, Hedera testnet tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All integration tests pass</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E2E Tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full user journey tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All scenarios complete successfully</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deploy Production</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Blue-green deployment to production</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zero-downtime deployment complete</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post-Deploy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Smoke tests, monitoring verification</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All health checks pass</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deployment_success_criteria">Deployment Success Criteria</h5>
<div class="ulist">
<ul>
<li>
<p>All pods reach <code>Ready</code> state within 5 minutes</p>
</li>
<li>
<p>Health check endpoints return 200 OK</p>
</li>
<li>
<p>No error spike in monitoring (&gt;1% error rate triggers rollback)</p>
</li>
<li>
<p>Database migrations complete successfully</p>
</li>
<li>
<p>Hedera connectivity verified</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_secrets_management">2.8.6. Secrets Management</h4>
<div class="sect4">
<h5 id="_secret_categories">Secret Categories</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Secrets</th>
<th class="tableblock halign-left valign-top">Storage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PostgreSQL credentials, connection strings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes Secrets / Vault</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JWT signing keys, refresh token secrets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vault / KMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operator account ID, private keys, token IDs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vault with strict access control</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">External</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Middle DB credentials, API keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vault / Sealed Secrets</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_key_rotation_policy">Key Rotation Policy</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Secret Type</th>
<th class="tableblock halign-left valign-top">Rotation Frequency</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JWT Signing Keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90 days</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database Passwords</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90 days</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Operator Keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual (with audit)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API Keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">180 days</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cross_cutting_concepts">3. Cross-cutting Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the overarching concepts and design decisions that apply across multiple components of the Enda Tamweel Loyalty Platform. These cross-cutting concerns ensure consistency and quality throughout the system.</p>
</div>
<div class="sect2">
<h3 id="_overview_5">3.1. Overview</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Concept</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication, authorization, encryption, and key management strategies</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optimization techniques for batch processing, caching, and API response times</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Monitoring &amp; Logging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Observability infrastructure including logs, metrics, traces, and alerting</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Protection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privacy controls, data classification, and regulatory compliance measures</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_security_concept">3.2. Security Concept</h3>
<div class="paragraph">
<p>This section describes the security architecture and controls implemented in the Enda Tamweel Loyalty Platform to protect user data, credentials, and token operations.</p>
</div>
<div class="sect3">
<h4 id="_authentication_architecture">3.2.1. Authentication Architecture</h4>
<div class="sect4">
<h5 id="_jwt_token_strategy">JWT Token Strategy</h5>
<div class="paragraph">
<p>The platform implements a dual-token authentication strategy to balance security with user experience:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Token Type</th>
<th class="tableblock halign-left valign-top">Characteristics</th>
<th class="tableblock halign-left valign-top">Storage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access Token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short-lived (15 minutes), contains user ID, role, username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frontend memory only (never localStorage/sessionStorage)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refresh Token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long-lived (7 days), bound to specific session</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP-only, Secure cookie (inaccessible to JavaScript)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_token_security_measures">Token Security Measures</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Access Token in Memory</strong>: Stored only in frontend application memory to prevent XSS attacks. Token is lost when page closes, requiring re-authentication or refresh.</p>
</li>
<li>
<p><strong>Refresh Token Rotation</strong>: Each refresh request generates a new refresh token pair:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Backend validates the existing refresh token</p>
</li>
<li>
<p>Old refresh token is invalidated in database</p>
</li>
<li>
<p>New refresh token and access token issued</p>
</li>
<li>
<p>New refresh token sent as HTTP-only cookie</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Refresh Token Hashing</strong>: Refresh tokens are hashed (bcrypt) before storage in the database. Even if the database is compromised, tokens cannot be used directly.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_session_management">Session Management</h5>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-ee3e6f55ca7f40fc69353a7b631ac94e.png" alt="Diagram" width="645" height="420">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hedera_wallet_security">3.2.2. Hedera Wallet Security</h4>
<div class="sect4">
<h5 id="_private_key_protection">Private Key Protection</h5>
<div class="paragraph">
<p>Client Hedera private keys require special security handling:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Control</th>
<th class="tableblock halign-left valign-top">Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encryption at Rest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private keys encrypted using AES-256-GCM before database storage</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key Derivation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encryption keys derived using PBKDF2 with unique salts per user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access Control</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private keys decrypted only during token operations, never exposed via API</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Memory Handling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keys cleared from memory immediately after use</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backup Security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database backups encrypted; keys stored separately from encrypted data</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_token_operation_authorization">Token Operation Authorization</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operation</th>
<th class="tableblock halign-left valign-top">Authorization</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mint Tokens</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Platform admin key only (backend-controlled)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Burn Tokens</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Platform admin key + verified redemption approval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">View Balance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authenticated user (own balance) or Admin (any user)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled - tokens are non-transferable between users</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_api_security">3.2.3. API Security</h4>
<div class="sect4">
<h5 id="_transport_security">Transport Security</h5>
<div class="ulist">
<ul>
<li>
<p>All external communication encrypted using <strong>TLS 1.3</strong></p>
</li>
<li>
<p>HSTS (HTTP Strict Transport Security) enabled</p>
</li>
<li>
<p>Certificate pinning for mobile applications</p>
</li>
<li>
<p>Internal service-to-service communication within Kubernetes uses mTLS</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_request_authentication">Request Authentication</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Endpoint Type</th>
<th class="tableblock halign-left valign-top">Authentication Method</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None (login, registration, public info)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Protected</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bearer token (JWT access token) in Authorization header</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bearer token + role verification (Admin or Super Admin)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service mesh authentication (mTLS)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_rate_limiting">Rate Limiting</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Endpoint Category</th>
<th class="tableblock halign-left valign-top">Rate Limit</th>
<th class="tableblock halign-left valign-top">Window</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 requests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 minute</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token Refresh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 requests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 minute</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API General</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 requests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 minute</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Admin Operations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50 requests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 minute</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_role_based_access_control_rbac">3.2.4. Role-Based Access Control (RBAC)</h4>
<div class="sect4">
<h5 id="_role_hierarchy">Role Hierarchy</h5>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-3db5d62f123829beb68ae1766e375a03.png" alt="Diagram" width="1073" height="336">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_permission_matrix">Permission Matrix</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">Client</th>
<th class="tableblock halign-left valign-top">Admin</th>
<th class="tableblock halign-left valign-top">Super Admin</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">View Own Balance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request Redemption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">View Gift Catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Approve Redemptions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manage Gift Catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">View All Users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manage Admin Accounts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">View Audit Logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">System Configuration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_security_monitoring">3.2.5. Security Monitoring</h4>
<div class="sect4">
<h5 id="_audit_events">Audit Events</h5>
<div class="paragraph">
<p>All security-relevant events are logged:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Authentication events (login, logout, failed attempts)</p>
</li>
<li>
<p>Token refresh events</p>
</li>
<li>
<p>Role changes</p>
</li>
<li>
<p>Admin account modifications</p>
</li>
<li>
<p>Token mint/burn operations</p>
</li>
<li>
<p>Redemption approvals/rejections</p>
</li>
<li>
<p>Permission denied attempts</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_security_alerts">Security Alerts</h5>
<div class="paragraph">
<p>Automated alerts for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Multiple failed login attempts (&gt;5 in 10 minutes)</p>
</li>
<li>
<p>Unusual token refresh patterns</p>
</li>
<li>
<p>Admin actions outside business hours</p>
</li>
<li>
<p>Large token operations (burn &gt; threshold)</p>
</li>
<li>
<p>Database access anomalies</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cookie_security_settings">3.2.6. Cookie Security Settings</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HttpOnly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true (prevents JavaScript access)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true (HTTPS only)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SameSite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Strict (CSRF protection)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/api/auth (restricted scope)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max-Age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">604800 (7 days)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_performance_optimization">3.3. Performance Optimization</h3>
<div class="paragraph">
<p>This section describes the performance optimization strategies implemented in the Enda Tamweel Loyalty Platform to ensure responsive user experience and efficient batch processing.</p>
</div>
<div class="sect3">
<h4 id="_batch_processing_architecture">3.3.1. Batch Processing Architecture</h4>
<div class="sect4">
<h5 id="_daily_points_calculation">Daily Points Calculation</h5>
<div class="paragraph">
<p>The daily points calculation processes thousands of client records efficiently:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Strategy</th>
<th class="tableblock halign-left valign-top">Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chunked Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client records processed in chunks of 100 to prevent memory overflow</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel Calculation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Points calculation runs in parallel worker threads (4 workers default)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database Batching</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bulk INSERT/UPDATE operations instead of individual queries</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Progress Tracking</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checkpoint system to resume from failure point</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_token_minting_optimization">Token Minting Optimization</h5>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-75d75ae3ec686127631eec134869d4cd.png" alt="Diagram" width="271" height="583">
</div>
</div>
<div class="paragraph">
<p>Key optimizations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Batch Size</strong>: Maximum 100 operations per Hedera transaction to balance throughput and fees</p>
</li>
<li>
<p><strong>Rate Limiting</strong>: Controlled submission rate to avoid network throttling</p>
</li>
<li>
<p><strong>Retry Logic</strong>: Exponential backoff for failed transactions (max 3 retries)</p>
</li>
<li>
<p><strong>Fee Optimization</strong>: Transactions scheduled during lower-fee periods when possible</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_caching_strategy">3.3.2. Caching Strategy</h4>
<div class="sect4">
<h5 id="_cache_layers">Cache Layers</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 28.5715%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Layer</th>
<th class="tableblock halign-left valign-top">Technology</th>
<th class="tableblock halign-left valign-top">TTL</th>
<th class="tableblock halign-left valign-top">Data Cached</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In-memory (Node.js)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request lifetime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parsed tokens, config</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Distributed Cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sessions, user data, gift catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database Cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PostgreSQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query plan cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frequent queries</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_redis_caching_implementation">Redis Caching Implementation</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Cache Key Pattern</th>
<th class="tableblock halign-left valign-top">TTL</th>
<th class="tableblock halign-left valign-top">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user:{id}:profile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User profile data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user:{id}:balance</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cached token balance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gifts:catalog</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 hour</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gift catalog (all users)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>session:{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 days</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Active session data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rate:{ip}:{endpoint}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 minute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rate limiting counters</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_cache_invalidation">Cache Invalidation</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Event</th>
<th class="tableblock halign-left valign-top">Invalidation Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token mint/burn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invalidate <code>user:{id}:balance</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Profile update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invalidate <code>user:{id}:profile</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gift catalog change</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invalidate <code>gifts:catalog</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delete <code>session:{id}</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_database_optimization">3.3.3. Database Optimization</h4>
<div class="sect4">
<h5 id="_indexing_strategy">Indexing Strategy</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Table</th>
<th class="tableblock halign-left valign-top">Index</th>
<th class="tableblock halign-left valign-top">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idx_users_username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login lookup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idx_users_hedera_account</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera account lookup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">points_history</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idx_points_user_date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily points query</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">redemptions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idx_redemptions_status</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending redemptions query</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">audit_logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idx_audit_timestamp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time-based audit queries</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_query_optimization">Query Optimization</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Pagination</strong>: All list endpoints use cursor-based pagination</p>
</li>
<li>
<p><strong>Projection</strong>: SELECT only required columns, avoid SELECT *</p>
</li>
<li>
<p><strong>Connection Pooling</strong>: pgBouncer for connection management (max 100 connections)</p>
</li>
<li>
<p><strong>Read Replicas</strong>: Read-heavy queries routed to replicas</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_response_optimization">3.3.4. API Response Optimization</h4>
<div class="sect4">
<h5 id="_response_time_targets">Response Time Targets</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Endpoint Category</th>
<th class="tableblock halign-left valign-top">P50 Target</th>
<th class="tableblock halign-left valign-top">P95 Target</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">300ms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User Profile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">150ms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Balance Query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">250ms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gift Catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100ms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redemption Create</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">200ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500ms</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_optimization_techniques">Optimization Techniques</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Response Compression</strong>: gzip compression for responses &gt; 1KB</p>
</li>
<li>
<p><strong>JSON Serialization</strong>: Fast JSON serializer (fastify-json)</p>
</li>
<li>
<p><strong>Connection Keep-Alive</strong>: HTTP/2 with connection reuse</p>
</li>
<li>
<p><strong>Early Response</strong>: Return success immediately, process async when possible</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_asynchronous_processing">3.3.5. Asynchronous Processing</h4>
<div class="sect4">
<h5 id="_job_queue_architecture">Job Queue Architecture</h5>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-6aa685afa37479f214375e69b2aef20e.png" alt="Diagram" width="290" height="435">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_job_types_and_priorities">Job Types and Priorities</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Job Type</th>
<th class="tableblock halign-left valign-top">Priority</th>
<th class="tableblock halign-left valign-top">Timeout</th>
<th class="tableblock halign-left valign-top">Retry Policy</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily Sync</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 hours</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 retries, exponential backoff</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Points Calculation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 hour</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 retries</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token Minting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 retries, exponential backoff</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Balance Reconciliation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 hour</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 retries</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notification</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 retry</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_hedera_network_optimization">3.3.6. Hedera Network Optimization</h4>
<div class="sect4">
<h5 id="_transaction_efficiency">Transaction Efficiency</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Account Consolidation</strong>: Platform uses single operator account for all mint/burn operations</p>
</li>
<li>
<p><strong>Auto Token Association</strong>: Tokens auto-associated during account creation</p>
</li>
<li>
<p><strong>Transaction Batching</strong>: Multiple operations combined where possible</p>
</li>
<li>
<p><strong>Testnet vs Mainnet</strong>: Development uses testnet to minimize costs</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_network_monitoring">Network Monitoring</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric</th>
<th class="tableblock halign-left valign-top">Threshold</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transaction success rate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;99%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Average consensus time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;5 seconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily transaction count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Monitor for anomalies</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fee spend (HBAR)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Budget alerting</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_performance_monitoring">3.3.7. Performance Monitoring</h4>
<div class="sect4">
<h5 id="_key_performance_indicators_kpis">Key Performance Indicators (KPIs)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">KPI</th>
<th class="tableblock halign-left valign-top">Target</th>
<th class="tableblock halign-left valign-top">Alert Threshold</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API Response Time (P95)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;500ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;1000ms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily Batch Completion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;4 hours</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;6 hours</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database Query Time (P95)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;100ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;500ms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cache Hit Rate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;90%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;80%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error Rate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;0.1%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;1%</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_monitoring_and_logging">3.4. Monitoring and Logging</h3>
<div class="paragraph">
<p>This section describes the monitoring, logging, and observability architecture for the Enda Tamweel Loyalty Platform.</p>
</div>
<div class="sect3">
<h4 id="_logging_architecture">3.4.1. Logging Architecture</h4>
<div class="sect4">
<h5 id="_log_levels_and_usage">Log Levels and Usage</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Level</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System failures requiring immediate attention</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database connection failure, Hedera transaction failure, unhandled exceptions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Potential issues that don&#8217;t prevent operation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retry attempts, degraded performance, cache misses</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Normal operational events</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User login, token minting, redemption approval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEBUG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Detailed information for troubleshooting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request/response payloads, calculation steps</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TRACE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Very detailed debugging information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Function entry/exit, variable values</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_structured_logging_format">Structured Logging Format</h5>
<div class="paragraph">
<p>All logs follow a structured JSON format for easy parsing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "timestamp": "2025-12-16T10:30:45.123Z",
  "level": "INFO",
  "service": "backend-api",
  "traceId": "abc123def456",
  "spanId": "span789",
  "userId": "user-001",
  "action": "token.mint",
  "details": {
    "amount": 100,
    "accountId": "0.0.12345"
  },
  "duration": 245
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_log_categories">Log Categories</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Events Logged</th>
<th class="tableblock halign-left valign-top">Retention</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication, authorization, access denied</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 year</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token operations, redemptions, admin actions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 years (compliance)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business logic, errors, warnings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90 days</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Response times, queue metrics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30 days</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Debug</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Detailed troubleshooting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 days</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_centralized_logging_stack">3.4.2. Centralized Logging Stack</h4>
<div class="sect4">
<h5 id="_architecture_2">Architecture</h5>
<div class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-8c4fe877c356e4327ea912499fe4498f.png" alt="Diagram" width="548" height="811">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_kibana_dashboards">Kibana Dashboards</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Dashboard</th>
<th class="tableblock halign-left valign-top">Content</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operations Overview</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request volume, error rates, response times, active users</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Dashboard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login attempts, failed authentications, permission denials</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token Operations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minting volume, burning events, balance changes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit Trail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All audit events with filtering by user, action, time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error Analysis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error trends, stack traces, affected users</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_audit_logging">3.4.3. Audit Logging</h4>
<div class="sect4">
<h5 id="_mandatory_audit_events">Mandatory Audit Events</h5>
<div class="paragraph">
<p>All of the following events are logged with full context:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Events</th>
<th class="tableblock halign-left valign-top">Data Captured</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login, logout, token refresh, failed login</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User ID, IP, timestamp, user agent, result</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Registration, profile update, password change</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User ID, changed fields, admin (if applicable)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token Operations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mint, burn, balance query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User ID, amount, transaction ID, account ID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redemption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request, approval, rejection, completion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User ID, gift ID, approver, status change</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Admin Actions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Admin creation, role change, system config</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Admin ID, target, changes made</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Export, bulk query, report generation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User ID, data type, scope</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_audit_log_format">Audit Log Format</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "auditId": "audit-20251216-001234",
  "timestamp": "2025-12-16T10:30:45.123Z",
  "eventType": "TOKEN_MINT",
  "actorId": "system-batch",
  "actorType": "SYSTEM",
  "targetId": "user-12345",
  "targetType": "USER",
  "action": "MINT",
  "details": {
    "amount": 150,
    "hederaTxId": "0.0.1234@1702721445.123456789",
    "previousBalance": 500,
    "newBalance": 650,
    "reason": "DAILY_POINTS"
  },
  "result": "SUCCESS",
  "ipAddress": "10.0.1.50",
  "correlationId": "batch-2025-12-16"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_metrics_and_monitoring">3.4.4. Metrics and Monitoring</h4>
<div class="sect4">
<h5 id="_prometheus_metrics">Prometheus Metrics</h5>
<div class="sect5">
<h6 id="_application_metrics">Application Metrics</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http_requests_total</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total HTTP requests by endpoint, method, status</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http_request_duration_seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request duration distribution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>active_users_total</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Currently active user sessions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>token_operations_total</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token mints and burns by type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>job_queue_size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current job queue depth</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>job_processing_duration_seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job processing time</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_hedera_specific_metrics">Hedera-Specific Metrics</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hedera_transactions_total</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera transactions by type and result</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hedera_transaction_duration_seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Histogram</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time from submission to consensus</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hedera_fee_hbar_total</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total HBAR spent on fees</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hedera_account_balance_hbar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operator account balance</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_grafana_dashboards">Grafana Dashboards</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Dashboard</th>
<th class="tableblock halign-left valign-top">Panels</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">System Overview</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request rate, error rate, latency percentiles, active connections</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Operations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transaction success rate, consensus time, fee tracking, daily volume</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business Metrics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Points calculated, tokens minted, redemptions processed, user growth</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Infrastructure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CPU, memory, disk, network for all services</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query performance, connection pool, table sizes</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_alerting">3.4.5. Alerting</h4>
<div class="sect4">
<h5 id="_alert_rules">Alert Rules</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 16.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Alert</th>
<th class="tableblock halign-left valign-top">Condition</th>
<th class="tableblock halign-left valign-top">Severity</th>
<th class="tableblock halign-left valign-top">Response</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">High Error Rate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error rate &gt; 1% for 5 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">On-call page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API Latency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P95 &gt; 2 seconds for 10 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Slack notification</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Failure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transaction failures &gt; 5% for 5 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">On-call page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database Connection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Available connections &lt; 10%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auto-scale + page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Batch Job Delay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily job not complete by 8 AM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Slack notification</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low HBAR Balance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operator balance &lt; 100 HBAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Email to finance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Event</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt; 10 failed logins from same IP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security team alert</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_alert_channels">Alert Channels</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Channel</th>
<th class="tableblock halign-left valign-top">Alert Types</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PagerDuty/On-call</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical production issues</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Slack #alerts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Warnings, performance degradation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily summaries, non-urgent issues</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Team</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security-related events</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_distributed_tracing">3.4.6. Distributed Tracing</h4>
<div class="sect4">
<h5 id="_implementation">Implementation</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Technology</strong>: OpenTelemetry with Jaeger backend</p>
</li>
<li>
<p><strong>Trace Propagation</strong>: W3C Trace Context headers</p>
</li>
<li>
<p><strong>Sampling</strong>: 10% of requests in production, 100% for errors</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_trace_points">Trace Points</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Service</th>
<th class="tableblock halign-left valign-top">Instrumented Operations</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API Gateway</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All incoming requests</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backend Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database queries, Hedera calls, cache operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job Workers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job processing, external calls</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query execution time</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_log_retention_policy">3.4.7. Log Retention Policy</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Log Type</th>
<th class="tableblock halign-left valign-top">Hot Storage</th>
<th class="tableblock halign-left valign-top">Cold Storage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit Logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90 days (Elasticsearch)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 years (S3 Glacier)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30 days (Elasticsearch)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90 days (S3)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security Logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90 days (Elasticsearch)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 year (S3)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Debug Logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 days (Elasticsearch)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not retained</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metrics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30 days (Prometheus)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 year (Thanos)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_data_protection_and_privacy">3.5. Data Protection and Privacy</h3>
<div class="paragraph">
<p>This section describes the data protection measures and privacy controls implemented in the Enda Tamweel Loyalty Platform to ensure compliance with applicable regulations and protect user data.</p>
</div>
<div class="sect3">
<h4 id="_regulatory_framework">3.5.1. Regulatory Framework</h4>
<div class="sect4">
<h5 id="_applicable_regulations">Applicable Regulations</h5>
<div class="paragraph">
<p>The platform is designed to comply with:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Regulation</th>
<th class="tableblock halign-left valign-top">Applicability</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tunisia Personal Data Protection Law (Law 2004-63)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary regulation for Enda Tamweel operations in Tunisia</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GDPR Principles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Applied as best practice for data protection</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Financial Services Regulations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microfinance and banking data requirements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Network Compliance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public blockchain data considerations</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_data_classification">3.5.2. Data Classification</h4>
<div class="sect4">
<h5 id="_data_categories">Data Categories</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 28.5715%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Examples</th>
<th class="tableblock halign-left valign-top">Sensitivity</th>
<th class="tableblock halign-left valign-top">Storage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Personal Identifiable Information (PII)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name, email, phone, national ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encrypted at rest</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Financial Data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Loan details, point balances, transactions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encrypted at rest</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication Credentials</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password hashes, refresh tokens</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hashed + encrypted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cryptographic Keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera private keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES-256 encrypted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public Blockchain Data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera account IDs, transaction IDs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inherently public</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_data_handling_by_location">Data Handling by Location</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Location</th>
<th class="tableblock halign-left valign-top">Data Type</th>
<th class="tableblock halign-left valign-top">Protection</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User profiles, points history, redemptions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encryption at rest (AES-256), TLS in transit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis Cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Session data, temporary balances</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In-memory, TLS, auto-expiry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Network</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account IDs, token balances, transaction records</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public by design (no PII stored on-chain)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log Storage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit logs, application logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encryption, access control, retention limits</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_on_chain_data_considerations">3.5.3. On-Chain Data Considerations</h4>
<div class="sect4">
<h5 id="_what_is_stored_on_chain">What is Stored On-Chain</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Data</th>
<th class="tableblock halign-left valign-top">On-Chain</th>
<th class="tableblock halign-left valign-top">Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Account ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required for token operations; not personally identifiable alone</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token Balance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core functionality; linked to account ID only</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transaction Records</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Immutable audit trail; contains only account IDs and amounts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User Name/Email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PII never stored on-chain</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private Keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored encrypted in application database</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redemption Details</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored in application database only</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_blockchain_data_privacy">Blockchain Data Privacy</h5>
<div class="paragraph">
<p>The platform ensures privacy by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Account Pseudonymity</strong>: Hedera account IDs are not linked to user identity on-chain</p>
</li>
<li>
<p><strong>Off-Chain PII</strong>: All personally identifiable information stored in traditional database</p>
</li>
<li>
<p><strong>Link Protection</strong>: The mapping between user ID and Hedera account is protected in the application database</p>
</li>
<li>
<p><strong>Minimal On-Chain Data</strong>: Only essential token operations recorded on Hedera</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_encryption_standards">3.5.4. Encryption Standards</h4>
<div class="sect4">
<h5 id="_encryption_at_rest">Encryption at Rest</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Data Type</th>
<th class="tableblock halign-left valign-top">Algorithm</th>
<th class="tableblock halign-left valign-top">Key Management</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database Fields</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES-256-GCM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AWS KMS / Azure Key Vault</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Private Keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES-256-GCM with PBKDF2 key derivation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique salt per user, master key in KMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backup Files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES-256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Separate backup encryption key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log Archives</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES-256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log-specific encryption key</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_encryption_in_transit">Encryption in Transit</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Connection</th>
<th class="tableblock halign-left valign-top">Protocol</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client to API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS 1.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service to Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS/SSL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service to Redis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service to Hedera</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS/TLS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal Services</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mTLS (Kubernetes)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_user_rights_management">3.5.5. User Rights Management</h4>
<div class="sect4">
<h5 id="_supported_user_rights">Supported User Rights</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Right</th>
<th class="tableblock halign-left valign-top">Implementation</th>
<th class="tableblock halign-left valign-top">Limitations</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Right to Access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User can view all their data via profile and history endpoints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit logs access restricted to admins</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Right to Rectification</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Users can update profile information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Historical transaction data immutable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Right to Erasure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account deactivation with data anonymization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">On-chain data cannot be deleted (public ledger)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Right to Data Portability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Export endpoint provides user data in JSON format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token balance viewable on Hedera explorer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Right to Restriction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account can be suspended by admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Existing on-chain balance preserved</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_data_retention">Data Retention</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Data Type</th>
<th class="tableblock halign-left valign-top">Retention Period</th>
<th class="tableblock halign-left valign-top">Deletion Method</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Active User Data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duration of account</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Anonymized on closure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deactivated Accounts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 years (regulatory requirement)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hard delete after period</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transaction History</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 years</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Archived then deleted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit Logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 years</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Archived to cold storage</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Session Data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 days after logout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auto-deleted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">On-Chain Data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permanent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cannot be deleted (Hedera design)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_data_anonymization">3.5.6. Data Anonymization</h4>
<div class="sect4">
<h5 id="_anonymization_for_account_closure">Anonymization for Account Closure</h5>
<div class="paragraph">
<p>When a user requests account deletion:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Profile Data</strong>: Name, email, phone replaced with anonymous values</p>
</li>
<li>
<p><strong>Transaction History</strong>: User ID replaced with anonymized identifier</p>
</li>
<li>
<p><strong>Audit Logs</strong>: User reference replaced with "DELETED_USER_{hash}"</p>
</li>
<li>
<p><strong>Hedera Account</strong>: Account remains but association removed from system</p>
</li>
<li>
<p><strong>Tokens</strong>: Remaining balance burned before closure</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_anonymization_for_testing">Anonymization for Testing</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Original Field</th>
<th class="tableblock halign-left valign-top">Anonymized Form</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Faker-generated name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:hash@test.example.com">hash@test.example.com</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Phone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Random valid format number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">National ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Random valid format ID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Account</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testnet account</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_access_control">3.5.7. Access Control</h4>
<div class="sect4">
<h5 id="_data_access_matrix">Data Access Matrix</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Data</th>
<th class="tableblock halign-left valign-top">User</th>
<th class="tableblock halign-left valign-top">Admin</th>
<th class="tableblock halign-left valign-top">Super Admin</th>
<th class="tableblock halign-left valign-top">System</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Own Profile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read/Write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Own Balance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read/Write</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Own Transactions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read/Write</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Other User Data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read/Write</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decrypt for signing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit Logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limited</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_data_protection_impact_assessment_dpia">3.5.8. Data Protection Impact Assessment (DPIA)</h4>
<div class="sect4">
<h5 id="_risk_assessment_summary">Risk Assessment Summary</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 28.5715%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Risk</th>
<th class="tableblock halign-left valign-top">Likelihood</th>
<th class="tableblock halign-left valign-top">Impact</th>
<th class="tableblock halign-left valign-top">Mitigation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PII Exposure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encryption, access control, monitoring</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key Compromise</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HSM/KMS, encryption, key rotation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">On-Chain Privacy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No PII on-chain, pseudonymous accounts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unauthorized Access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RBAC, MFA for admins, audit logging</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Breach</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encryption, incident response plan</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_incident_response">3.5.9. Incident Response</h4>
<div class="sect4">
<h5 id="_data_breach_protocol">Data Breach Protocol</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Detection</strong>: Automated monitoring alerts security team</p>
</li>
<li>
<p><strong>Containment</strong>: Isolate affected systems, revoke compromised credentials</p>
</li>
<li>
<p><strong>Assessment</strong>: Determine scope of breach, data affected</p>
</li>
<li>
<p><strong>Notification</strong>: Notify authorities within 72 hours if required</p>
</li>
<li>
<p><strong>User Communication</strong>: Inform affected users with guidance</p>
</li>
<li>
<p><strong>Remediation</strong>: Patch vulnerabilities, enhance controls</p>
</li>
<li>
<p><strong>Post-Incident</strong>: Review and update security measures</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture_decisions">4. Architecture Decisions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Architecture Decision Records (ADRs) serve several important purposes and follow a specific process. Here&#8217;s an explanation of their purpose and process:</p>
</div>
<div class="paragraph">
<p>Purpose of ADRs:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Document key decisions: ADRs capture significant architectural decisions made during the design and development of a software system <a href="https://learn.microsoft.com/en-us/azure/well-architected/architect-role/architecture-decision-record">1</a> <a href="https://adr.github.io">2</a>.</p>
</li>
<li>
<p>Provide context: They explain the context, rationale, and consequences of each decision <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html">3</a>.</p>
</li>
<li>
<p>Create a decision log: ADRs collectively form a decision log that provides project context and detailed implementation information <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html">3</a>.</p>
</li>
<li>
<p>Facilitate communication: They help team members understand and communicate design choices <a href="https://endjin.com/blog/2023/07/architecture-decision-records">4</a>.</p>
</li>
<li>
<p>Support future reference: ADRs serve as a reference for code and architectural reviews <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html">3</a>.</p>
</li>
<li>
<p>Track evolution: They allow documentation to reflect specific states of a system over time <a href="https://endjin.com/blog/2023/07/architecture-decision-records">4</a>.</p>
</li>
<li>
<p>Evidence thinking process: ADRs demonstrate the reasoning behind decisions, which can be valuable for audits or future team members <a href="https://endjin.com/blog/2023/07/architecture-decision-records">4</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Process of creating and using ADRs:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Identification: Recognize an architecturally significant decision that needs to be made <a href="https://learn.microsoft.com/en-us/azure/well-architected/architect-role/architecture-decision-record">1</a> <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html">3</a>.</p>
</li>
<li>
<p>Authorship: An team member (ADR owner) creates a new ADR document <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html">3</a>.</p>
</li>
<li>
<p>Content creation: The ADR owner fills in the required sections, typically including:</p>
<div class="ulist">
<ul>
<li>
<p>Title</p>
</li>
<li>
<p>Status (e.g., proposed, accepted, rejected)</p>
</li>
<li>
<p>Context and problem statement</p>
</li>
<li>
<p>Decision drivers</p>
</li>
<li>
<p>Considered options</p>
</li>
<li>
<p>Decision outcome</p>
</li>
<li>
<p>Pros and cons</p>
</li>
<li>
<p>Mitigation strategy <a href="https://endjin.com/blog/2023/07/architecture-decision-records">4</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Review: The team reviews the proposed ADR, often using a pull request process in a version control system <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html">3</a> <a href="https://endjin.com/blog/2023/07/architecture-decision-records">4</a>.</p>
</li>
<li>
<p>Revision: If necessary, the ADR owner makes revisions based on team feedback <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html">3</a>.</p>
</li>
<li>
<p>Acceptance or Rejection: The team decides to accept, reject, or request further work on the ADR <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html">3</a>.</p>
</li>
<li>
<p>Finalization: If accepted, the ADR owner updates the status, adds a timestamp, version, and list of stakeholders <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html">3</a>.</p>
</li>
<li>
<p>Storage: ADRs are typically stored as plain text (often Markdown) files in a version control system, usually in a <code>/docs/adrs</code> folder within the project repository <a href="https://endjin.com/blog/2023/07/architecture-decision-records">4</a>.</p>
</li>
<li>
<p>Ongoing use: The team refers to ADRs during development, code reviews, and future decision-making processes <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html">3</a>.</p>
</li>
<li>
<p>Superseding: If a decision changes, a new ADR is created to supersede the old one, rather than modifying the original ADR <a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html">3</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>By following this process, teams can maintain a clear, versioned history of important decisions throughout a project&#8217;s lifecycle, improving communication, understanding, and long-term maintainability of the software architecture.</p>
</div>
<div class="sect2">
<h3 id="_adr_001_use_hedera_token_service_hts_for_loyalty_points_tokenization">4.1. ADR 001: Use Hedera Token Service (HTS) for Loyalty Points Tokenization</h3>
<div class="paragraph">
<p><strong>Status</strong>: Accepted</p>
</div>
<div class="paragraph">
<p><strong>Date</strong>: December 2025</p>
</div>
<div class="paragraph">
<p><strong>Context</strong>:
Enda Tamweel requires a loyalty points system that provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Transparent and immutable record of point balances</p>
</li>
<li>
<p>Ability to mint and burn tokens based on business rules</p>
</li>
<li>
<p>Low transaction costs for frequent operations</p>
</li>
<li>
<p>Integration with existing banking systems</p>
</li>
<li>
<p>Regulatory compliance for financial operations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternative approaches considered:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Traditional Database Only</strong>: Store points in PostgreSQL without blockchain</p>
</li>
<li>
<p><strong>Ethereum ERC-20 Token</strong>: Deploy custom smart contract on Ethereum</p>
</li>
<li>
<p><strong>Private Blockchain</strong>: Deploy on Hyperledger or private network</p>
</li>
<li>
<p><strong>Hedera Token Service (HTS)</strong>: Use Hedera&#8217;s native tokenization service</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Decision:</strong>
We will use <strong>Hedera Token Service (HTS)</strong> for tokenizing loyalty points.</p>
</div>
<div class="paragraph">
<p>Rationale:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Native Tokenization</strong>: HTS provides built-in token functionality without custom smart contracts</p>
</li>
<li>
<p><strong>Low Fees</strong>: Predictable, low-cost transactions ($0.001 or less per operation)</p>
</li>
<li>
<p><strong>Fast Finality</strong>: 3-5 second consensus time for all transactions</p>
</li>
<li>
<p><strong>Enterprise Grade</strong>: Governed by major enterprises, suitable for financial applications</p>
</li>
<li>
<p><strong>Built-in Controls</strong>: Native support for minting, burning, and admin keys</p>
</li>
<li>
<p><strong>Compliance</strong>: Transaction fees in USD-equivalent, easy for accounting</p>
</li>
<li>
<p><strong>SDK Support</strong>: Official JavaScript SDK integrates well with NestJS backend</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Consequences</strong>:</p>
</div>
<div class="paragraph">
<p>Positive:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Transparent, auditable record of all token operations on public ledger</p>
</li>
<li>
<p>No smart contract vulnerabilities to manage</p>
</li>
<li>
<p>Low operational costs compared to Ethereum</p>
</li>
<li>
<p>Fast transaction confirmation for good user experience</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Negative:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dependency on Hedera network availability</p>
</li>
<li>
<p>On-chain data is public (mitigated by not storing PII on-chain)</p>
</li>
<li>
<p>Requires HBAR for transaction fees</p>
</li>
<li>
<p>Team needs to learn Hedera SDK</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_adr_002_use_nestjs_as_backend_framework">4.2. ADR 002: Use NestJS as Backend Framework</h3>
<div class="paragraph">
<p><strong>Status</strong>: Accepted</p>
</div>
<div class="paragraph">
<p><strong>Date</strong>: December 2025</p>
</div>
<div class="paragraph">
<p><strong>Context</strong>:
The backend service needs to handle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RESTful API endpoints for web and mobile clients</p>
</li>
<li>
<p>Scheduled batch jobs for daily data processing</p>
</li>
<li>
<p>Integration with Hedera SDK (JavaScript/TypeScript)</p>
</li>
<li>
<p>Integration with PostgreSQL and Redis</p>
</li>
<li>
<p>Secure authentication and authorization</p>
</li>
<li>
<p>Scalable architecture for growing user base</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternative frameworks considered:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Express.js</strong>: Minimal, flexible Node.js framework</p>
</li>
<li>
<p><strong>Fastify</strong>: High-performance Node.js framework</p>
</li>
<li>
<p><strong>NestJS</strong>: Enterprise-grade TypeScript framework</p>
</li>
<li>
<p><strong>Django (Python)</strong>: Full-featured Python web framework</p>
</li>
<li>
<p><strong>Spring Boot (Java)</strong>: Enterprise Java framework</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Decision:</strong>
We will use <strong>NestJS</strong> as the backend framework.</p>
</div>
<div class="paragraph">
<p>Rationale:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>TypeScript Native</strong>: Strong typing reduces bugs and improves maintainability</p>
</li>
<li>
<p><strong>Modular Architecture</strong>: Built-in module system aligns with our component design</p>
</li>
<li>
<p><strong>Dependency Injection</strong>: Enterprise patterns for testable, maintainable code</p>
</li>
<li>
<p><strong>Ecosystem</strong>: Excellent packages for PostgreSQL (TypeORM), Redis (Bull), JWT</p>
</li>
<li>
<p><strong>Hedera Compatibility</strong>: JavaScript SDK works seamlessly with TypeScript</p>
</li>
<li>
<p><strong>Team Expertise</strong>: Development team has strong TypeScript experience</p>
</li>
<li>
<p><strong>Documentation</strong>: Comprehensive documentation and active community</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Consequences</strong>:</p>
</div>
<div class="paragraph">
<p>Positive:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clean, modular codebase with clear separation of concerns</p>
</li>
<li>
<p>Strong typing catches errors at compile time</p>
</li>
<li>
<p>Easy to write unit and integration tests</p>
</li>
<li>
<p>Excellent support for background job processing</p>
</li>
<li>
<p>Guards and interceptors simplify authentication/authorization</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Negative:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Steeper learning curve than Express.js</p>
</li>
<li>
<p>More boilerplate code for simple endpoints</p>
</li>
<li>
<p>Requires TypeScript build step</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_related_requirements">4.2.1. Related Requirements</h4>
<div class="ulist">
<ul>
<li>
<p><a href="../01_introduction_and_goals/02_requirements_overview.html#RE7">R7</a> - JWT-based authentication</p>
</li>
<li>
<p><a href="../01_introduction_and_goals/03_quality_goals.html#Q6">Q6</a> - Maintainability</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adr_003_jwt_authentication_with_refresh_token_rotation">4.3. ADR 003: JWT Authentication with Refresh Token Rotation</h3>
<div class="paragraph">
<p><strong>Status</strong>: Accepted</p>
</div>
<div class="paragraph">
<p><strong>Date</strong>: December 2025</p>
</div>
<div class="paragraph">
<p><strong>Context</strong>:
The platform requires secure authentication for three user types (Client, Admin, Super Admin) with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Protection against common web vulnerabilities (XSS, CSRF)</p>
</li>
<li>
<p>Seamless user experience without frequent re-authentication</p>
</li>
<li>
<p>Support for web and mobile applications</p>
</li>
<li>
<p>Ability to revoke sessions immediately</p>
</li>
<li>
<p>Audit trail of authentication events</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternative approaches considered:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Session-based Authentication</strong>: Traditional server-side sessions</p>
</li>
<li>
<p><strong>Simple JWT</strong>: Single long-lived JWT token</p>
</li>
<li>
<p><strong>OAuth 2.0 with External Provider</strong>: Delegate authentication to Auth0, Okta</p>
</li>
<li>
<p><strong>JWT with Refresh Token Rotation</strong>: Short-lived access tokens with rotating refresh tokens</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Decision:</strong>
We will implement <strong>JWT authentication with refresh token rotation</strong>.</p>
</div>
<div class="paragraph">
<p>Implementation details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Access Token</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Short-lived (15 minutes)</p>
</li>
<li>
<p>Contains user ID, role, username</p>
</li>
<li>
<p>Stored in frontend memory only (not localStorage)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Refresh Token</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Long-lived (7 days)</p>
</li>
<li>
<p>Stored as HTTP-only, Secure cookie</p>
</li>
<li>
<p>Hashed before database storage</p>
</li>
<li>
<p>Rotated on each refresh (old token invalidated)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Rationale:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>XSS Protection</strong>: Access token in memory cannot be stolen by XSS attacks</p>
</li>
<li>
<p><strong>CSRF Protection</strong>: HTTP-only cookies with SameSite=Strict prevent CSRF</p>
</li>
<li>
<p><strong>Token Theft Mitigation</strong>: Rotation means stolen refresh token becomes invalid quickly</p>
</li>
<li>
<p><strong>Session Control</strong>: Database storage allows immediate revocation</p>
</li>
<li>
<p><strong>Mobile Support</strong>: Works with both web (cookies) and mobile (secure storage)</p>
</li>
<li>
<p><strong>Audit Capability</strong>: All authentication events can be logged</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Consequences</strong>:</p>
</div>
<div class="paragraph">
<p>Positive:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Strong security against common attack vectors</p>
</li>
<li>
<p>Users stay logged in for extended periods without re-authentication</p>
</li>
<li>
<p>Immediate session revocation capability</p>
</li>
<li>
<p>Clear audit trail of authentication events</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Negative:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>More complex implementation than simple JWT</p>
</li>
<li>
<p>Requires database lookup for refresh token validation</p>
</li>
<li>
<p>Cookie handling differs between web and mobile</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_security_controls">4.3.1. Security Controls</h4>
<div class="ulist">
<ul>
<li>
<p>Refresh tokens hashed with bcrypt before storage</p>
</li>
<li>
<p>Cookie settings: HttpOnly=true, Secure=true, SameSite=Strict</p>
</li>
<li>
<p>Rate limiting on authentication endpoints</p>
</li>
<li>
<p>Account lockout after failed attempts</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_related_requirements_2">4.3.2. Related Requirements</h4>
<div class="ulist">
<ul>
<li>
<p><a href="../01_introduction_and_goals/02_requirements_overview.html#RE7">R7</a> - JWT-based authentication</p>
</li>
<li>
<p><a href="../01_introduction_and_goals/03_quality_goals.html#Q1">Q1</a> - Security</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adr_004_custodial_wallet_architecture_for_client_hedera_accounts">4.4. ADR 004: Custodial Wallet Architecture for Client Hedera Accounts</h3>
<div class="paragraph">
<p><strong>Status</strong>: Accepted</p>
</div>
<div class="paragraph">
<p><strong>Date</strong>: December 2025</p>
</div>
<div class="paragraph">
<p><strong>Context</strong>:
Each client needs a Hedera account to hold their loyalty tokens. The key management approach affects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User experience (onboarding complexity)</p>
</li>
<li>
<p>Security responsibility distribution</p>
</li>
<li>
<p>Operational requirements</p>
</li>
<li>
<p>Recovery procedures</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternative approaches considered:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Non-Custodial (User Holds Keys)</strong>: Users manage their own Hedera keys</p>
</li>
<li>
<p><strong>Hardware Wallet Integration</strong>: Users use hardware wallets</p>
</li>
<li>
<p><strong>MPC (Multi-Party Computation)</strong>: Keys split between user and platform</p>
</li>
<li>
<p><strong>Fully Custodial</strong>: Platform manages all client keys</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Decision:</strong>
We will implement a <strong>fully custodial wallet architecture</strong> where the platform manages all client Hedera account keys.</p>
</div>
<div class="paragraph">
<p>Implementation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hedera accounts created automatically during user registration</p>
</li>
<li>
<p>Private keys encrypted with AES-256-GCM using per-user derived keys</p>
</li>
<li>
<p>Encryption master key stored in cloud KMS (AWS KMS / Azure Key Vault)</p>
</li>
<li>
<p>Platform admin key controls all mint/burn operations</p>
</li>
<li>
<p>Users cannot transfer tokens independently</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Rationale:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>User Experience</strong>: Clients interact with familiar web/mobile interface</p>
</li>
<li>
<p><strong>Target Audience</strong>: Microfinance clients may not be blockchain-savvy</p>
</li>
<li>
<p><strong>Operational Control</strong>: Platform maintains full control over token lifecycle</p>
</li>
<li>
<p><strong>Key Recovery</strong>: Platform can recover access if database is restored</p>
</li>
<li>
<p><strong>Closed Ecosystem</strong>: Tokens cannot be used outside the platform anyway</p>
</li>
<li>
<p><strong>Simplified Support</strong>: No need for user key recovery procedures</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Consequences</strong>:</p>
</div>
<div class="paragraph">
<p>Positive:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Seamless onboarding - users don&#8217;t need to understand blockchain</p>
</li>
<li>
<p>No risk of users losing access due to lost keys</p>
</li>
<li>
<p>Simplified mobile app without wallet complexity</p>
</li>
<li>
<p>Full control over token operations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Negative:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Platform is fully responsible for key security</p>
</li>
<li>
<p>Single point of failure if platform is compromised</p>
</li>
<li>
<p>Users must trust platform completely</p>
</li>
<li>
<p>Not "true" decentralization</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_security_requirements">4.4.1. Security Requirements</h4>
<div class="ulist">
<ul>
<li>
<p>Private keys encrypted at rest with AES-256-GCM</p>
</li>
<li>
<p>Encryption keys managed by cloud KMS with strict IAM</p>
</li>
<li>
<p>Keys decrypted only in memory during signing operations</p>
</li>
<li>
<p>Database backups encrypted separately</p>
</li>
<li>
<p>Regular key rotation for encryption keys</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_related_requirements_3">4.4.2. Related Requirements</h4>
<div class="ulist">
<ul>
<li>
<p><a href="../01_introduction_and_goals/02_requirements_overview.html#RE1">R1</a> - Automatic Hedera wallet creation</p>
</li>
<li>
<p><a href="../01_introduction_and_goals/03_quality_goals.html#Q1">Q1</a> - Security</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adr_005_daily_batch_processing_for_points_calculation_and_token_minting">4.5. ADR 005: Daily Batch Processing for Points Calculation and Token Minting</h3>
<div class="paragraph">
<p><strong>Status</strong>: Accepted</p>
</div>
<div class="paragraph">
<p><strong>Date</strong>: December 2025</p>
</div>
<div class="paragraph">
<p><strong>Context</strong>:
The platform needs to calculate loyalty points based on client activity data from Middle DB and mint corresponding tokens. Key considerations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Middle DB is updated daily with J-1 (previous day) data</p>
</li>
<li>
<p>Thousands of clients need points calculated</p>
</li>
<li>
<p>Token minting has associated Hedera network fees</p>
</li>
<li>
<p>System should handle processing failures gracefully</p>
</li>
<li>
<p>Results need to be auditable</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternative approaches considered:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Real-time Processing</strong>: Calculate and mint on each transaction</p>
</li>
<li>
<p><strong>Hourly Batch</strong>: Process every hour</p>
</li>
<li>
<p><strong>Daily Batch</strong>: Process once daily aligned with Middle DB refresh</p>
</li>
<li>
<p><strong>Weekly Batch</strong>: Aggregate and process weekly</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Decision:</strong>
We will implement <strong>daily batch processing</strong> for points calculation and token minting.</p>
</div>
<div class="paragraph">
<p>Processing schedule:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Trigger</strong>: Scheduled cron job at 2:00 AM (after Middle DB J-1 refresh)</p>
</li>
<li>
<p><strong>Data Extraction</strong>: Read all client activity from Middle DB</p>
</li>
<li>
<p><strong>Points Calculation</strong>: Apply business rules to compute daily points</p>
</li>
<li>
<p><strong>Token Minting</strong>: Batch mint tokens to client accounts</p>
</li>
<li>
<p><strong>Completion Target</strong>: Process complete by 6:00 AM</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Rationale:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Data Alignment</strong>: Matches Middle DB J-1 update cycle</p>
</li>
<li>
<p><strong>Cost Efficiency</strong>: Batch minting reduces per-transaction overhead</p>
</li>
<li>
<p><strong>System Load</strong>: Processing during off-peak hours</p>
</li>
<li>
<p><strong>Business Fit</strong>: Daily points aligns with Enda Tamweel&#8217;s operational model</p>
</li>
<li>
<p><strong>Error Handling</strong>: Daily cycle allows time for retry and manual intervention</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Implementation Details:</strong></p>
</div>
<div class="sect4">
<h5 id="_job_queue_architecture_2">Job Queue Architecture</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Daily Sync Job
 Data Extraction (from Middle DB)
 Points Calculation (parallel workers)
    Chunk 1 (100 clients)
    Chunk 2 (100 clients)
    ...
 Token Minting (batch operations)
    Batch 1 (max 100 operations)
    Batch 2 (max 100 operations)
    ...
 Reconciliation Check
 Summary Report</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_checkpointing">Checkpointing</h5>
<div class="ulist">
<ul>
<li>
<p>Progress saved after each chunk</p>
</li>
<li>
<p>Failed jobs resume from last checkpoint</p>
</li>
<li>
<p>Maximum 3 automatic retries with exponential backoff</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_monitoring">Monitoring</h5>
<div class="ulist">
<ul>
<li>
<p>Job start/completion alerts</p>
</li>
<li>
<p>Error rate monitoring</p>
</li>
<li>
<p>Processing time tracking</p>
</li>
<li>
<p>Automatic escalation if not complete by deadline</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Consequences</strong>:</p>
</div>
<div class="paragraph">
<p>Positive:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Efficient use of Hedera network with batched operations</p>
</li>
<li>
<p>Clear processing window with defined completion time</p>
</li>
<li>
<p>Easy to monitor and troubleshoot</p>
</li>
<li>
<p>Aligns with existing data refresh cycles</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Negative:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Points not reflected in real-time (24-hour delay)</p>
</li>
<li>
<p>Large processing window if client base grows significantly</p>
</li>
<li>
<p>Failure affects all clients for that day</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_related_requirements_4">4.5.4. Related Requirements</h4>
<div class="ulist">
<ul>
<li>
<p><a href="../01_introduction_and_goals/02_requirements_overview.html#RE2">R2</a> - Daily extraction from Middle DB</p>
</li>
<li>
<p><a href="../01_introduction_and_goals/02_requirements_overview.html#RE3">R3</a> - Rule-based points calculation</p>
</li>
<li>
<p><a href="../01_introduction_and_goals/02_requirements_overview.html#RE4">R4</a> - Automatic minting</p>
</li>
<li>
<p><a href="../01_introduction_and_goals/03_quality_goals.html#Q4">Q4</a> - Scalability</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quality_assurance_testing_strategy">5. Quality Assurance Testing Strategy</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_testing_scope">5.1. Testing Scope</h3>
<div class="paragraph">
<p>The testing team will execute validation of the changes that include but not limited to the following activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Integration</p>
</li>
<li>
<p>System Security</p>
</li>
<li>
<p>Authorization &amp; Authentication</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_test_platform">5.1.1. Test Platform</h4>
<div class="ulist">
<ul>
<li>
<p>Website</p>
</li>
<li>
<p>Mobile App</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_tools">5.1.2. Tools</h4>
<div class="ulist">
<ul>
<li>
<p>Website &amp; Mobile Manual Testing Tools: Test Link, MS Azure DevOps</p>
</li>
<li>
<p>Website Automation Test Tools: JMETER, Selenium &amp; Python</p>
</li>
<li>
<p>Mobile Automation Testing Tools: Appium, Java and BrowserStack (Multiple devices)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_test_types">5.1.3. Test Types</h4>
<div class="ulist">
<ul>
<li>
<p>End-to-End Testing: Testing entire product from beginning to end to ensure the application flow with expected behaviours.</p>
</li>
<li>
<p>Functional Testing: Aligns &amp; validate the system functional requirements / specifications.</p>
</li>
<li>
<p>Non-Functional Testing: Load &amp; Performance Testing.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_performance_testing">5.1.4. Performance Testing</h4>
<div class="ulist">
<ul>
<li>
<p>Website Performance Testing Tools: JMETER</p>
<div class="ulist">
<ul>
<li>
<p>Up to max. 1000 concurrent users</p>
</li>
<li>
<p>Up to 95% Loading Performance</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_product">5.1.5. Product</h4>
<div class="ulist">
<ul>
<li>
<p>All</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_supported_mobile_devices">5.1.6. Supported Mobile Devices</h4>
<div class="ulist">
<ul>
<li>
<p>iOS 17+</p>
</li>
<li>
<p>Android 14+</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_levels">5.2. Testing Levels</h3>
<div class="paragraph">
<p>This section describes the different levels of testing implemented for the Enda Tamweel Loyalty Platform.</p>
</div>
<div class="sect3">
<h4 id="_unit_testing">5.2.1. Unit Testing</h4>
<div class="sect4">
<h5 id="_scope">Scope</h5>
<div class="paragraph">
<p>Individual functions, methods, and classes in isolation.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tools_2">Tools</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Framework</strong>: Jest</p>
</li>
<li>
<p><strong>Mocking</strong>: jest-mock, ts-mockito</p>
</li>
<li>
<p><strong>Coverage</strong>: Istanbul/nyc</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_coverage_targets">Coverage Targets</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Module</th>
<th class="tableblock halign-left valign-top">Minimum Coverage</th>
<th class="tableblock halign-left valign-top">Priority</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Points Engine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical - core business logic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auth Module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">85%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Critical - security</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token Module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High - Hedera operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gift Module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High - business workflow</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API Controllers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">70%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_unit_test_examples">Unit Test Examples</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Component</th>
<th class="tableblock halign-left valign-top">Test Cases</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Points Calculator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Points calculation rules, edge cases, error handling</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JWT Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token generation, validation, expiry handling</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Wallet Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key encryption/decryption, account creation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redemption Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request validation, status transitions</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_integration_testing">5.2.2. Integration Testing</h4>
<div class="sect4">
<h5 id="_scope_2">Scope</h5>
<div class="paragraph">
<p>Interaction between modules and external dependencies.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tools_3">Tools</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Framework</strong>: Jest with supertest</p>
</li>
<li>
<p><strong>Database</strong>: Testcontainers (PostgreSQL)</p>
</li>
<li>
<p><strong>Hedera</strong>: Hedera Testnet</p>
</li>
<li>
<p><strong>Redis</strong>: Testcontainers (Redis)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_integration_test_scenarios">Integration Test Scenarios</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Scenario</th>
<th class="tableblock halign-left valign-top">Validations</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User Registration Flow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database record created, Hedera account created, wallet encrypted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication Flow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login creates session, refresh rotates tokens, logout invalidates</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Points Calculation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Middle DB data processed, database updated, tokens minted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gift Redemption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request persisted, approval triggers burn, balance updated</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_external_system_integration">External System Integration</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">System</th>
<th class="tableblock halign-left valign-top">Test Approach</th>
<th class="tableblock halign-left valign-top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PostgreSQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testcontainers with schema migration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Isolated container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testcontainers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Isolated container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Network</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera Testnet with test accounts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public testnet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Middle DB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mock data or staging replica</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mock/Staging</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_end_to_end_e2e_testing">5.2.3. End-to-End (E2E) Testing</h4>
<div class="sect4">
<h5 id="_scope_3">Scope</h5>
<div class="paragraph">
<p>Complete user journeys through the entire system.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tools_4">Tools</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Web</strong>: Playwright</p>
</li>
<li>
<p><strong>Mobile</strong>: Detox (React Native)</p>
</li>
<li>
<p><strong>API</strong>: Postman/Newman</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_e2e_test_scenarios">E2E Test Scenarios</h5>
<div class="sect5">
<h6 id="_client_journey">Client Journey</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Test Case</th>
<th class="tableblock halign-left valign-top">Steps</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">New Client Onboarding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register  Verify account created  View initial balance (0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check Balance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login  Navigate to dashboard  Verify balance matches expected</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request Gift Redemption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login  Browse gifts  Select gift  Submit request  Verify pending status</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">View Transaction History</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login  Navigate to history  Verify past transactions displayed</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_admin_journey">Admin Journey</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Test Case</th>
<th class="tableblock halign-left valign-top">Steps</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Approve Redemption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login as Admin  View pending  Approve  Verify tokens burned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reject Redemption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login as Admin  View pending  Reject with reason  Verify status</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manage Gift Catalog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login as Admin  Add gift  Edit gift  Verify updates</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_super_admin_journey">Super Admin Journey</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Test Case</th>
<th class="tableblock halign-left valign-top">Steps</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manage Admins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login as Super Admin  Create admin  Modify permissions  Deactivate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">View Audit Logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login as Super Admin  Navigate to audit  Filter by date/action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_contract_testing">5.2.4. API Contract Testing</h4>
<div class="sect4">
<h5 id="_scope_4">Scope</h5>
<div class="paragraph">
<p>Validate API contracts and backward compatibility.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tools_5">Tools</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Contract Definition</strong>: OpenAPI 3.0</p>
</li>
<li>
<p><strong>Contract Testing</strong>: Dredd, Pact</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_api_tests">API Tests</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Endpoint</th>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Validations</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/auth/login</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request/response schema, error codes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/users/me</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication required, response structure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/balance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correct balance returned, caching behavior</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/redemptions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validation errors, success response</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_performance_testing_2">5.2.5. Performance Testing</h4>
<div class="sect4">
<h5 id="_tools_6">Tools</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Load Testing</strong>: k6, JMeter</p>
</li>
<li>
<p><strong>Profiling</strong>: clinic.js, 0x</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_performance_test_scenarios">Performance Test Scenarios</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 28.5715%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Scenario</th>
<th class="tableblock halign-left valign-top">Users</th>
<th class="tableblock halign-left valign-top">Duration</th>
<th class="tableblock halign-left valign-top">Success Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Normal Load</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 concurrent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P95 &lt; 500ms, 0% errors</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Peak Load</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 concurrent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P95 &lt; 1000ms, &lt; 0.1% errors</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Batch Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10,000 records</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single run</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complete &lt; 4 hours</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stress Test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 concurrent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graceful degradation</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_security_testing">5.2.6. Security Testing</h4>
<div class="sect4">
<h5 id="_tools_7">Tools</h5>
<div class="ulist">
<ul>
<li>
<p><strong>SAST</strong>: SonarQube, Semgrep</p>
</li>
<li>
<p><strong>DAST</strong>: OWASP ZAP</p>
</li>
<li>
<p><strong>Dependency Scan</strong>: Snyk, npm audit</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_security_test_areas">Security Test Areas</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Area</th>
<th class="tableblock halign-left valign-top">Tests</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brute force protection, session management, token validation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authorization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Role enforcement, privilege escalation attempts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input Validation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL injection, XSS, command injection</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API Security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rate limiting, CORS, security headers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Protection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encryption validation, key management</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_test_environment_strategy">5.2.7. Test Environment Strategy</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 28.5715%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Environment</th>
<th class="tableblock halign-left valign-top">Purpose</th>
<th class="tableblock halign-left valign-top">Data</th>
<th class="tableblock halign-left valign-top">Hedera Network</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Developer testing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mock/seed data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testnet or Mock</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CI/CD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Automated tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated test data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testnet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Staging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integration &amp; E2E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Anonymized production</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testnet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pre-Production</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final validation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Production replica</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testnet</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_testing_strategy">5.3. Testing Strategy</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Section</th>
<th class="tableblock halign-left valign-top">Details</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1. Test Strategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1 Automation / Manual Test Strategy<br>
1.2 Test Schedule<br>
1.3 Resource Planning</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2. Test Development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.1 Test Plans<br>
2.2 Test Scripts<br>
2.3 Test Data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3. Test Execution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.1 Defects<br>
3.2 Test Reports<br>
3.3 Test Metrics (Traceability Matrix)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4. Defect Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.1 Bug Tracking<br>
4.2 Bug Fixing<br>
4.3 Bug Verification</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5. Delivery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.1 UAT<br>
5.2 Installation Testing Environment<br>
5.3 Requirements Verification</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_risk_technical_debt">6. Risk &amp; Technical Debt</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_risks">6.1. Risks</h3>
<div class="paragraph">
<p>The following risks represent potential future uncertainties that may impact the Enda Tamweel Loyalty Platform if not addressed:</p>
</div>
<table id="Risks" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 16.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ID</th>
<th class="tableblock halign-left valign-top">Severity</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Remediation</th>
<th class="tableblock halign-left valign-top">Status</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RI1"></a>R1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera network outage or degradation could prevent token operations (minting, burning, balance queries)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implement circuit breaker pattern; queue failed operations for retry; maintain cached balances in database; monitor Hedera network status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Monitoring in place</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RI2"></a>R2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private key compromise could allow unauthorized token operations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keys encrypted with AES-256 and stored in KMS; strict access controls; regular security audits; key rotation procedures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mitigated</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RI3"></a>R3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Middle DB integration failure could halt daily points calculation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implement retry logic; manual trigger capability; alerting for sync failures; fallback to previous day&#8217;s data if critical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Monitoring in place</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RI4"></a>R4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rapid user growth exceeds batch processing capacity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Horizontal scaling of worker pods; chunked processing; performance monitoring; capacity planning reviews</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Planned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RI5"></a>R5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database discrepancy between application DB and on-chain token balances</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily reconciliation job; automated alerts for discrepancies; manual review process; audit logging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implemented</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RI6"></a>R6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Users lose access to accounts and cannot recover</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard password reset flow; admin-assisted account recovery; no user-held keys to lose (custodial model)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mitigated by design</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RI7"></a>R7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HBAR price volatility affects operational costs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Budget buffer for fee fluctuations; batch operations to minimize transactions; monitor daily costs; alert on budget threshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Monitoring in place</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RI8"></a>R8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data breach exposing user personal information or encrypted keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encryption at rest and in transit; WAF and DDoS protection; incident response plan; regular penetration testing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security measures active</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RI9"></a>R9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regulatory changes affecting blockchain token operations in Tunisia</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Monitor regulatory landscape; design for flexibility; maintain compliance documentation; legal review of operations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Under monitoring</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="RI10"></a>R10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Third-party dependency vulnerabilities (npm packages, SDKs)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Automated vulnerability scanning (Snyk); regular dependency updates; security-focused code reviews</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CI/CD integrated</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_risk_matrix">6.1.1. Risk Matrix</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Low Impact</th>
<th class="tableblock halign-left valign-top">Medium Impact</th>
<th class="tableblock halign-left valign-top">High Impact</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">High Likelihood</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R4, R7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R1, R8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium Likelihood</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R3, R5, R9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low Likelihood</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R6</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_risk_monitoring">6.1.2. Risk Monitoring</h4>
<div class="sect4">
<h5 id="_automated_monitoring">Automated Monitoring</h5>
<div class="ulist">
<ul>
<li>
<p>Hedera network status integration</p>
</li>
<li>
<p>Database reconciliation alerts</p>
</li>
<li>
<p>Security vulnerability scanning</p>
</li>
<li>
<p>Cost tracking and budget alerts</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_regular_reviews">Regular Reviews</h5>
<div class="ulist">
<ul>
<li>
<p>Weekly: Operational risks review</p>
</li>
<li>
<p>Monthly: Security posture assessment</p>
</li>
<li>
<p>Quarterly: Full risk register review</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_technical_debt">6.2. Technical Debt</h3>
<div class="paragraph">
<p>The following technical debt items represent known deficiencies in the current system implementation.
They are acknowledged and planned for future resolution:</p>
</div>
<table id="Technical-Debt" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 16.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ID</th>
<th class="tableblock halign-left valign-top">Severity</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Remediation</th>
<th class="tableblock halign-left valign-top">Target</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TD1"></a>TD1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hedera operator credentials stored in environment variables rather than secure vault</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Migrate to HashiCorp Vault or cloud KMS for all sensitive credentials</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sprint 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TD2"></a>TD2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limited automated test coverage for Hedera integration layer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add comprehensive integration tests using Hedera Testnet; mock SDK for unit tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sprint 4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TD3"></a>TD3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Points calculation rules hardcoded in service; no admin interface for rule management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implement rule engine with database-driven configuration; add admin UI for rule management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Phase 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TD4"></a>TD4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Batch processing does not support partial failure recovery from exact failure point</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implement fine-grained checkpointing; store progress per client; resume from exact failure point</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sprint 5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TD5"></a>TD5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No rate limiting on internal service-to-service communication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implement service mesh with rate limiting; add circuit breakers between services</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sprint 6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TD6"></a>TD6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit log query performance degrades with large datasets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implement log partitioning; add time-based indexes; consider moving to time-series database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Phase 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TD7"></a>TD7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mobile app stores JWT access token in secure storage instead of memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refactor mobile auth to use memory-only storage with background refresh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sprint 4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TD8"></a>TD8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">API documentation not automatically generated from code annotations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrate Swagger/OpenAPI generation from NestJS decorators; publish to developer portal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sprint 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TD9"></a>TD9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No automated backup verification for encrypted private keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implement automated backup restore testing; verify key decryption from backups monthly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sprint 5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="TD10"></a>TD10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frontend components not fully accessible (WCAG compliance)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conduct accessibility audit; implement ARIA labels; keyboard navigation support</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Phase 2</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_technical_debt_tracking">6.2.1. Technical Debt Tracking</h4>
<div class="sect4">
<h5 id="_prioritization_criteria">Prioritization Criteria</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Severity</strong>: Impact on security, reliability, or user experience</p>
</li>
<li>
<p><strong>Effort</strong>: Development time required for resolution</p>
</li>
<li>
<p><strong>Risk</strong>: Likelihood of the debt causing issues</p>
</li>
<li>
<p><strong>Business Value</strong>: Benefit from resolution</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_review_cadence">Review Cadence</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Weekly</strong>: Review new debt items, update status</p>
</li>
<li>
<p><strong>Sprint Planning</strong>: Select debt items for inclusion</p>
</li>
<li>
<p><strong>Monthly</strong>: Technical debt burndown review</p>
</li>
<li>
<p><strong>Quarterly</strong>: Comprehensive debt assessment</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_debt_reduction_strategy">6.2.2. Debt Reduction Strategy</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Sprint Allocation</th>
<th class="tableblock halign-left valign-top">Approach</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">20% capacity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dedicated time each sprint for debt reduction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boy Scout Rule</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Leave code better than you found it</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refactoring Stories</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Major debt items tracked as user stories</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tech Spikes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time-boxed investigation for complex debt</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_features_traceability_matrix_rtm">7. Features Traceability Matrix (RTM)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This matrix traces platform features to their requirements, quality attributes, architecture decisions, and identified risks.</p>
</div>
<table id="ftm" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 8.3333%;">
<col style="width: 25%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6669%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ID</th>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">Requirements</th>
<th class="tableblock halign-left valign-top">Quality Attributes</th>
<th class="tableblock halign-left valign-top">Arch. Decisions</th>
<th class="tableblock halign-left valign-top">Risks/Tech Debt</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>User Authentication</strong>: Secure login with JWT tokens and refresh token rotation, protecting user sessions with HTTP-only cookies and in-memory access tokens.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/02_requirements_overview.html#RE7">R7 - JWT Auth</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/03_quality_goals.html#Q1">Q1 - Security</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./04_architecture_decisions/adr-003-authentication-strategy.html">ADR-003 Auth Strategy</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./06_risks_and_tech_debt/02_technical_debts.html#TD7">TD7 - Mobile Token Storage</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>User Registration</strong>: New client onboarding with automatic Hedera wallet creation and secure key storage.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/02_requirements_overview.html#RE1">R1 - Wallet Creation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/03_quality_goals.html#Q1">Q1 - Security</a>, <a href="./01_introduction_and_goals/03_quality_goals.html#Q6">Q6 - Maintainability</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./04_architecture_decisions/adr-004-custodial-wallet.html">ADR-004 Custodial Wallet</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./06_risks_and_tech_debt/01_risks.html#RI2">R2 - Key Compromise</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Daily Points Calculation</strong>: Automated daily extraction from Middle DB and rule-based points calculation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/02_requirements_overview.html#RE2">R2 - Daily Extraction</a>, <a href="./01_introduction_and_goals/02_requirements_overview.html#RE3">R3 - Points Engine</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/03_quality_goals.html#Q2">Q2 - Reliability</a>, <a href="./01_introduction_and_goals/03_quality_goals.html#Q4">Q4 - Scalability</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./04_architecture_decisions/adr-005-batch-processing.html">ADR-005 Batch Processing</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./06_risks_and_tech_debt/01_risks.html#RI3">R3 - Middle DB Integration</a>, <a href="./06_risks_and_tech_debt/02_technical_debts.html#TD3">TD3 - Hardcoded Rules</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Token Minting</strong>: Automatic minting of HTS loyalty tokens based on calculated points.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/02_requirements_overview.html#RE4">R4 - Auto Minting</a>, <a href="./01_introduction_and_goals/02_requirements_overview.html#IR2">IR2 - HTS Integration</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/03_quality_goals.html#Q2">Q2 - Reliability</a>, <a href="./01_introduction_and_goals/03_quality_goals.html#Q7">Q7 - Auditability</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./04_architecture_decisions/adr-001-my-project.html">ADR-001 HTS</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./06_risks_and_tech_debt/01_risks.html#RI1">R1 - Hedera Outage</a>, <a href="./06_risks_and_tech_debt/01_risks.html#RI7">R7 - HBAR Costs</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Gift Redemption</strong>: Client gift requests with admin approval workflow and token burning.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/02_requirements_overview.html#RE5">R5 - Redemption Workflow</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/03_quality_goals.html#Q7">Q7 - Auditability</a>, <a href="./01_introduction_and_goals/03_quality_goals.html#Q8">Q8 - Data Integrity</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./04_architecture_decisions/adr-001-my-project.html">ADR-001 HTS</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./06_risks_and_tech_debt/01_risks.html#RI5">R5 - Balance Discrepancy</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Admin Management</strong>: Super Admin panel for Admin account lifecycle management.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/02_requirements_overview.html#RE6">R6 - Super Admin Panel</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/03_quality_goals.html#Q1">Q1 - Security</a>, <a href="./01_introduction_and_goals/03_quality_goals.html#Q7">Q7 - Auditability</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./04_architecture_decisions/adr-003-authentication-strategy.html">ADR-003 Auth Strategy</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Balance Reconciliation</strong>: Regular comparison of database and on-chain token balances.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/02_requirements_overview.html#RE8">R8 - Reconciliation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/03_quality_goals.html#Q8">Q8 - Data Integrity</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./04_architecture_decisions/adr-001-my-project.html">ADR-001 HTS</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./06_risks_and_tech_debt/01_risks.html#RI5">R5 - Balance Discrepancy</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Transaction History</strong>: Storage and retrieval of historical point calculations and redemption logs.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/02_requirements_overview.html#RE9">R9 - History Storage</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/03_quality_goals.html#Q7">Q7 - Auditability</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./04_architecture_decisions/adr-002-backend-framework.html">ADR-002 NestJS</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./06_risks_and_tech_debt/02_technical_debts.html#TD6">TD6 - Audit Log Performance</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Web Application</strong>: React-based web interface for clients, admins, and super admins.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/02_requirements_overview.html#RE10">R10 - Web/Mobile Apps</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/03_quality_goals.html#Q3">Q3 - Performance</a>, <a href="./01_introduction_and_goals/03_quality_goals.html#Q5">Q5 - Availability</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./04_architecture_decisions/adr-002-backend-framework.html">ADR-002 NestJS</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./06_risks_and_tech_debt/02_technical_debts.html#TD10">TD10 - Accessibility</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Mobile Application</strong>: React Native mobile app for iOS and Android.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/02_requirements_overview.html#RE10">R10 - Web/Mobile Apps</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./01_introduction_and_goals/03_quality_goals.html#Q3">Q3 - Performance</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./04_architecture_decisions/adr-003-authentication-strategy.html">ADR-003 Auth Strategy</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./06_risks_and_tech_debt/02_technical_debts.html#TD7">TD7 - Mobile Token Storage</a></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_coverage_summary">7.1. Coverage Summary</h3>
<div class="sect3">
<h4 id="_requirements_coverage">7.1.1. Requirements Coverage</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Requirement</th>
<th class="tableblock halign-left valign-top">Covered By</th>
<th class="tableblock halign-left valign-top">Status</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R1 - Wallet Creation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R2 - Daily Extraction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R3 - Points Engine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R4 - Auto Minting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R5 - Redemption Workflow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R6 - Super Admin Panel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R7 - JWT Auth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R8 - Reconciliation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R9 - History Storage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R10 - Web/Mobile Apps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F9, F10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IR1 - Middle DB Integration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IR2 - HTS Integration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F4, F5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IR3 - Hedera Account Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_quality_attributes_coverage">7.1.2. Quality Attributes Coverage</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Quality Attribute</th>
<th class="tableblock halign-left valign-top">Covered By Features</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q1 - Security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F1, F2, F6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q2 - Reliability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F3, F4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q3 - Performance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F9, F10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q4 - Scalability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q5 - Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F9</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q6 - Maintainability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q7 - Auditability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F4, F5, F6, F8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q8 - Data Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F5, F7</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_adr_coverage">7.1.3. ADR Coverage</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ADR</th>
<th class="tableblock halign-left valign-top">Related Features</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADR-001 HTS Token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F4, F5, F7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADR-002 NestJS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F8, F9</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADR-003 Authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F1, F6, F10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADR-004 Custodial Wallet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADR-005 Batch Processing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F3</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0<br>
Last updated 2025-12-17 08:16:30 UTC
</div>
</div>
</body>
</html>